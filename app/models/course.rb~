class Course < ActiveRecord::Base
belongs_to :schedule
before_save { self.name = name.downcase }

package = Axlsx::Package.new
workbook = package.workbook
@courses = Course.all
workbook.add_worksheet(name: "Basic work sheet") do |sheet|
  sheet.add_row ["Course Name", "Description"]
  @courses.each do |s|
    sheet.add_row [s.name,s.description]
  end
end

workbook.styles do |s|
  heading = s.add_style alignment: {horizontal: :center}, b: true, sz: 18, bg_color: "0066CC", fg_color: "FF"
end

package.serialize "Basic.xlsx"
end
